
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">###Hide</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span> <span class="k">as</span> <span class="n">LDA</span>
<span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="kn">import</span> <span class="n">QuadraticDiscriminantAnalysis</span> <span class="k">as</span> <span class="n">QDA</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span> <span class="k">as</span> <span class="n">KNN</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span> <span class="k">as</span> <span class="n">DecisionTree</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span> <span class="k">as</span> <span class="n">RandomForest</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span> <span class="k">as</span> <span class="n">AdaBoost</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">grid_search</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">feature_selection</span> <span class="k">as</span> <span class="n">fs</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Scrubbing-Process">Data Scrubbing Process<a class="anchor-link" href="#Data-Scrubbing-Process">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Summary-of-the-data">Summary of the data<a class="anchor-link" href="#Summary-of-the-data">&#182;</a></h4><p>The National Child Development Study (NCDS) was a perinated mortality survey which examined the social factors assosiated with stillbirth and infant mortality over 17000 babies born in the UK during 1958. Since then the cohort has been survery on six other times in order to monitor their health. These surveys were carried out in 1965 (age 7), 1969 (age 11), 1974 (age 16), 1981 (age 23), 1991 (age 33) and 1999/2000 (age 41/42). As part of the 1991 survey, a special study was also undertaken of the children of one third of the cohort members, including assessments of the behaviour and cognitive development of approximately 5000 children. There have also been surveys of sub-samples of the cohort, the most recent occurring in 1996 (age 37) when information was collected on the basic skills of a 10% sample of cohort members. <a href="../references/ncds_and_bcs70_response.pdf">[reference]</a></p>
<p>There are three files that contain the survey responses from the various subjects. Our analysis will be for these three files.</p>
<p>File Name : ncds0123
, Number of variables =     1765
, Number of cases =     18558</p>
<p>File Name : ncds_pms_additionals
, Number of variables =     54
, Number of cases =     16990</p>
<p>File Name : ncds_response
, Number of variables =     18
, Number of cases =     18558</p>
<p>In the next section we will follow the data science pipline process to explore and clean the data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Explore-and-Clean-Data">Explore and Clean Data<a class="anchor-link" href="#Explore-and-Clean-Data">&#182;</a></h2><p>First task will be to read, explore, and clean the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-1:-Load-the-data">Step 1: Load the data<a class="anchor-link" href="#Step-1:-Load-the-data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#Load and inspect the ncds data</span>
<span class="n">ncds_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/ncds0123.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c1"># Print shapes</span>
<span class="k">print</span> <span class="s2">&quot;Shape of data:&quot;</span><span class="p">,</span> <span class="n">ncds_data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">ncds_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape of data: (18558, 1765)
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[2]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ncdsid</th>
      <th>n622</th>
      <th>n0region</th>
      <th>n1region</th>
      <th>n2region</th>
      <th>n3region</th>
      <th>n553</th>
      <th>n545</th>
      <th>n520</th>
      <th>n490</th>
      <th>...</th>
      <th>n1849</th>
      <th>dvht07</th>
      <th>dvht11</th>
      <th>dvht16</th>
      <th>dvrwt07</th>
      <th>dvrwt11</th>
      <th>dvrwt16</th>
      <th>dvwt07</th>
      <th>dvwt11</th>
      <th>dvwt16</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>N10001N</td>
      <td>2</td>
      <td>9</td>
      <td>9</td>
      <td>9</td>
      <td>9</td>
      <td>23</td>
      <td>4</td>
      <td>2</td>
      <td>12</td>
      <td>...</td>
      <td>-1</td>
      <td>1.21899986267032</td>
      <td>1.47299957275415</td>
      <td>1.59999942779607</td>
      <td>110.347991943347</td>
      <td>98.1929931640604</td>
      <td>105.055999755876</td>
      <td>25.8549957275385</td>
      <td>37.6489868164152</td>
      <td>56.0199890136717</td>
    </tr>
    <tr>
      <th>1</th>
      <td>N10002P</td>
      <td>1</td>
      <td>9</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>34</td>
      <td>4</td>
      <td>5</td>
      <td>1</td>
      <td>...</td>
      <td>-1</td>
      <td>1.34599971771224</td>
      <td>-1</td>
      <td>-1</td>
      <td>90.865997314449</td>
      <td>-1</td>
      <td>-1</td>
      <td>26.3089904785155</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>N10003Q</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>34</td>
      <td>4</td>
      <td>10</td>
      <td>1</td>
      <td>...</td>
      <td>-1</td>
      <td>1.32099914550831</td>
      <td>1.49899959564243</td>
      <td>1.87999916076665</td>
      <td>87.9599914550983</td>
      <td>96.4049987792867</td>
      <td>89.382995605487</td>
      <td>24.4939880371087</td>
      <td>38.1019897460905</td>
      <td>66.6799926757659</td>
    </tr>
    <tr>
      <th>3</th>
      <td>N10004R</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>26</td>
      <td>4</td>
      <td>11</td>
      <td>1</td>
      <td>...</td>
      <td>-1</td>
      <td>1.29499912262003</td>
      <td>1.51099967956562</td>
      <td>1.62999916076665</td>
      <td>105.16198730471</td>
      <td>111.588989257796</td>
      <td>132.054992675766</td>
      <td>28.122985839843</td>
      <td>45.8139953613169</td>
      <td>72.7999877929584</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N10005S</td>
      <td>2</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>25</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>-1</td>
      <td>1.34599971771224</td>
      <td>-1</td>
      <td>-1</td>
      <td>129.382995605487</td>
      <td>-1</td>
      <td>-1</td>
      <td>37.6489868164152</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1765 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#Load and inspect the pms additions data</span>
<span class="n">ncds_pms_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/ncds_pms_additionals.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c1"># Print shapes</span>
<span class="k">print</span> <span class="s2">&quot;Shape of data:&quot;</span><span class="p">,</span> <span class="n">ncds_pms_data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">ncds_pms_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape of data: (16990, 54)
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[3]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NCDSID</th>
      <th>N622</th>
      <th>BSTATUS</th>
      <th>POD</th>
      <th>BOOKING</th>
      <th>PLANC</th>
      <th>DIASTOL</th>
      <th>MAXDBP</th>
      <th>ALBECL</th>
      <th>XRAY</th>
      <th>...</th>
      <th>DTB8</th>
      <th>DTB9</th>
      <th>DTB10</th>
      <th>ILLNESS</th>
      <th>MOD</th>
      <th>TOD</th>
      <th>AAD</th>
      <th>SBNND</th>
      <th>PLCWGT</th>
      <th>TABLE62</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>N10001N</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-2</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>N10002P</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-2</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>N10003Q</td>
      <td>1</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-2</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>N10004R</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>-8</td>
      <td>-8</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-2</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N10005S</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-2</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 54 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#Load and inspect the response data</span>
<span class="n">ncds_response_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/ncds_response.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c1"># Print shapes</span>
<span class="k">print</span> <span class="s2">&quot;Shape of data:&quot;</span><span class="p">,</span> <span class="n">ncds_response_data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">ncds_response_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape of data: (18558, 18)
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[4]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NCDSID</th>
      <th>N622</th>
      <th>BSTATUS</th>
      <th>COBIRTH</th>
      <th>MULTIPNO</th>
      <th>MULTCODE</th>
      <th>ETHNICID</th>
      <th>OUTCME00</th>
      <th>OUTCME01</th>
      <th>OUTCME02</th>
      <th>OUTCME03</th>
      <th>OUTCME04</th>
      <th>OUTCME05</th>
      <th>OUTCME06</th>
      <th>OUTCMEBM</th>
      <th>OUTCME07</th>
      <th>OUTCME08</th>
      <th>OUTCME09</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>N10001N</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>N10002P</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>N10003Q</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>N10004R</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N10005S</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>-1</td>
      <td>-1</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us first join all the threee datasets, so we can work on all the data together.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Join datasets</span>
<span class="n">ncds_merged_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">ncds_data</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="n">ncds_pms_data</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ncdsid&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;NCDSID&#39;</span><span class="p">)</span>
<span class="n">ncds_merged_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">ncds_merged_data</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="n">ncds_response_data</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ncdsid&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;NCDSID&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Shape of data:&quot;</span><span class="p">,</span> <span class="n">ncds_merged_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape of data: (18558, 1837)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">#Hide</span>

<span class="c1"># Utility methods for data exploring and cleaning</span>
<span class="k">def</span> <span class="nf">evaluate_data</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># Check for range of unique values for the train data</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;(Categorical) {} unique values - {}: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;(Continuous) range of values - &#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;: {} to {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">evaluate_epil_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">epil_columns</span><span class="p">:</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;(Categorical) {} unique values - {}: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">column</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;(Continuous) range of values - &#39;</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="s1">&#39;: {} to {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">columns_with_null</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df_missing</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">df_missing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;Predictor &quot;</span> <span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="s2">&quot; contain null values / Count = &quot;</span> <span class="p">,</span><span class="n">df_missing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span><span class="mi">1</span>
    <span class="k">print</span> <span class="s2">&quot;Total number of columns with null:&quot;</span><span class="p">,</span><span class="n">count</span>

<span class="k">def</span> <span class="nf">find_columns_with_nulls</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df_missing</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">df_missing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">columns</span>

<span class="k">def</span> <span class="nf">find_columns_without_nulls</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df_missing</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">df_missing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">columns</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-2:-Understand-the-data">Step 2: Understand the data<a class="anchor-link" href="#Step-2:-Understand-the-data">&#182;</a></h4><ol>
<li>Explore the data</li>
<li>Understand the predictors, what they mean in real life</li>
<li>Understand the values of each predictors</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Data-Analysis-/-Exploration">Data Analysis / Exploration<a class="anchor-link" href="#Data-Analysis-/-Exploration">&#182;</a></h5><p>Most of our exploration was done in the data exploration step of our project. The details of the tasks we performed can be viewed <a href="20_exploratory_data_analysis_02.ipynb">here</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-3:-Handle-missing-data">Step 3: Handle missing data<a class="anchor-link" href="#Step-3:-Handle-missing-data">&#182;</a></h4><p>Are there any missing values, if there are:</p>
<ol>
<li>Can we impute them based on some algorithm</li>
<li>Remove or ignore them</li>
<li>Assume values based on common sense or prior knowledge</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">### Utility methods for data scrubbing</span>

<span class="c1"># Remove spaces from data</span>
<span class="k">def</span> <span class="nf">convert_spaces_to_null</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39; &#39;</span><span class="p">],[</span><span class="bp">None</span><span class="p">])</span> 
    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># Fill empty columns using median for the column</span>
<span class="k">def</span> <span class="nf">fill_with_median</span><span class="p">(</span><span class="n">x_fill</span><span class="p">):</span>
    <span class="n">x_fill</span> <span class="o">=</span> <span class="n">x_fill</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">x_fill</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">x_fill</span>

<span class="c1"># Fill empty columns using mean for the column</span>
<span class="k">def</span> <span class="nf">fill_with_mean</span><span class="p">(</span><span class="n">x_fill</span><span class="p">):</span>
    <span class="n">x_fill</span> <span class="o">=</span> <span class="n">x_fill</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">x_fill</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">x_fill</span>

<span class="c1"># Fill empty columns using KNN</span>
<span class="k">def</span> <span class="nf">fill_with_knn</span><span class="p">(</span><span class="n">x_fill</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">features</span><span class="p">,</span><span class="n">response</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">df_missing</span> <span class="o">=</span> <span class="n">x_fill</span><span class="p">[</span><span class="n">x_fill</span><span class="p">[</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
    <span class="n">df_filled</span> <span class="o">=</span> <span class="n">x_fill</span><span class="p">[</span><span class="o">~</span><span class="n">x_fill</span><span class="p">[</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
    <span class="n">df_predict</span> <span class="o">=</span> <span class="n">df_missing</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_filled</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df_filled</span><span class="p">[</span><span class="n">response</span><span class="p">])</span>
        <span class="n">df_predict</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">response</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_missing</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
        <span class="n">df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_filled</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">df_predict</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">response</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_filled</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">df_final</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First let is creata copy of the data and remove duplicate columns that were created when we merged the three datasets. Also from our data exploration step we found that the data with balnsk ave space and we need to convert them to nulls so it is easier to handle null checking in python. Then we need to convert all the column types to float type.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Make a copy</span>
<span class="n">ncds_data_clean</span> <span class="o">=</span> <span class="n">ncds_merged_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 

<span class="c1"># drop the ID columns</span>
<span class="n">ncds_data_clean</span> <span class="o">=</span>  <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;ncdsid&quot;</span><span class="p">,</span><span class="s2">&quot;NCDSID_x&quot;</span><span class="p">,</span><span class="s2">&quot;NCDSID_y&quot;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Drop other duplicate columns</span>
<span class="n">ncds_data_clean</span> <span class="o">=</span>  <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;N622_x&quot;</span><span class="p">,</span><span class="s2">&quot;BSTATUS_x&quot;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="c1"># Convert spaces in the data to nulls</span>
<span class="n">ncds_data_clean</span> <span class="o">=</span> <span class="n">convert_spaces_to_null</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>

<span class="c1"># Convert all columns to float</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">ncds_data_clean</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncds_data_clean</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The pms file ncds_pms_additionals has 16990 cases only, so we need to impute the columns to fill the null values.</p>
<p>The details on what we chose as the default value for each feature is listed here:</p>
<ul>
<li><strong>POD</strong>    , Label : Q6:Place of Delivery , Default Value = 5.0    , Label : Elsewhere      </li>
<li><strong>BOOKING</strong>    , Label : Q26b: Booking In place  , Default Value = 3.0    , Label : Other place    </li>
<li><strong>PLANC</strong>    , Label : Q21b: Place of Antenatal care , Default Value = -8.0    , Label : No information </li>
<li><strong>DIASTOL</strong>    , Label : Q29a: Diastolic Blood Pressure , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>MAXDBP</strong>    , Label : Q29b: Maximum Diatolic Blood Pressure , Default Value = -8.0    , Label : No information </li>
<li><strong>ALBECL</strong>    , Label : Q31: Albuminuria and Eclampsia , Default Value = -8.0    , Label : No information </li>
<li><strong>XRAY</strong>    , Label : Q36: X-Ray given , Default Value = -8.0    , Label : No information </li>
<li><strong>ABNORM0X</strong>    , Label : Q37: Obstetric, pregnancy abnormality - No information , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM00</strong>    , Label : Q37: No Obstetric, pregnancy abnormality , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM01</strong>    , Label : Q37: Obstetric, pregnancy abnormality - Diabetes , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM02</strong>    , Label : Q37: Obstetric, pregnancy abnormality - Heart , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM03</strong>    , Label : Q37: Obstetric, pregnancy abnormality - Active TB , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM04</strong>    , Label : Q37: Obstetric, pregnancy abnormality - influenza , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM05</strong>    , Label : Q37: Obstetric, pregnancy abnormality - German Measles , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM06</strong>    , Label : Q37: Obstetric, pregnancy abnormality - Disproportion , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM07</strong>    , Label : Q37: Obstetric, pregnancy abnormality - External version , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM08</strong>    , Label : Q37: Obstetric, pregnancy abnormality - Epilepsy , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ABNORM09</strong>    , Label : Q37: Obstetric, pregnancy abnormality - Other , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>BLEED</strong>    , Label : Q37: Bleeding in Pregnancy and before delivery  , Default Value = -1.0    , Label : No information </li>
<li><strong>AD2HOSP</strong>    , Label : Q38a: Admission to hospital , Default Value = -1.0    , Label : No information </li>
<li><strong>ADTYPE</strong>    , Label : Q39: Type of Labour or Delivery Admission (Hospital) , Default Value = -1.0    , Label : No information </li>
<li><strong>PRESENT</strong>    , Label : Q44: Presenting Part , Default Value = -1.0    , Label : No information </li>
<li><strong>LDRUG00</strong>    , Label : Q49a: No drugs of this type , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG01</strong>    , Label : Q49a: Chloral, Welldorm  , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG02</strong>    , Label : Q49a: Barbiturate , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG03</strong>    , Label : Q49a: Heroin , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG04</strong>    , Label : Q49a: Largactil (chlorpomazine) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG05</strong>    , Label : Q49a: Sparine (promazine) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG06</strong>    , Label : Q49a: Phenergan (promethazine) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG07</strong>    , Label : Q49a: Doriden  , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG08</strong>    , Label : Q49a: Oblivon , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>LDRUG09</strong>    , Label : Q49a: Other   , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ATHETIC</strong>    , Label : Q50: Anaesthetic , Default Value = 9.0    , Label : No information </li>
<li><strong>RESUS</strong>    , Label : Q55: Resuscitation   , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB1</strong>    , Label : Q56: Drugs to baby (None)  , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB2</strong>    , Label : Q56: Drugs to baby (Coranine) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB3</strong>    , Label : Q56: Drugs to baby (Lobeline) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB4</strong>    , Label : Q56: Drugs to baby (Sedatives) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB5</strong>    , Label : Q56: Drugs to baby (Antagonists, nalorphine, levalorfan) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB6</strong>    , Label : Q56: Drugs to baby (Synkavit, Vikastab)  , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB7</strong>    , Label : Q56: Drugs to baby (Sulphonamides)  , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB8</strong>    , Label : Q56: Drugs to baby (Penicilin) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB9</strong>    , Label : Q56: Drugs to baby (Streptomycin)    , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>DTB10</strong>    , Label : Q56: Drugs to baby (Other antibiotics) , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>ILLNESS</strong>    , Label : Q59: Baby's Illness  , Default Value = -1.0    , Label : No information </li>
<li><strong>MOD</strong>    , Label : Q61: Month of Death  , Default Value = 0.0    , Label : Survivor (livebirth /lived)    </li>
<li><strong>TOD</strong>    , Label : Q61: Time of death  , Default Value = -1.0    , Label : Not applicable </li>
<li><strong>AAD</strong>    , Label : Q61: Age at Death  , Default Value = -1.0    , Label : Not applicable </li>
<li><strong>SBNND</strong>    , Label : Q61: Still Birth or Neo-natal Death (Dervied)  , Default Value = -1.0    , Label : Survivor       </li>
<li><strong>PLCWGT</strong>    , Label : Placental Weight , Default Value = -2.0    , Label : Not applicable </li>
<li><strong>TABLE62</strong>    , Label : Time of death for still births and neonatal deaths (Table 62) , Default Value = -1.0    , Label : Not applicable </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">### method to fill nulls in the pms dataset</span>
<span class="k">def</span> <span class="nf">fill_pms_columns</span><span class="p">(</span><span class="n">x_fill</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">x_fill</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="c1"># Q6:Place of Delivery  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;POD&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;POD&#39;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
        <span class="c1"># Q26b: Booking In place  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;BOOKING&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;BOOKING&#39;</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="c1"># Q21b: Place of Antenatal care  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLANC&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;PLANC&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span><span class="p">)</span>
        <span class="c1"># Q29a: Diastolic Blood Pressure  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DIASTOL&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DIASTOL&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q29b: Maximum Diatolic Blood Pressure </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;MAXDBP&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;MAXDBP&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q31: Albuminuria and Eclampsia</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ALBECL&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ALBECL&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span><span class="p">)</span>
        <span class="c1"># Q36: X-Ray given</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;XRAY&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;XRAY&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - No information</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM0X&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM0X&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: No Obstetric, pregnancy abnormality</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM00&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM00&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - Diabetes</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM01&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM01&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - Heart </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM02&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM02&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - Active TB </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM03&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM03&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - influenza </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM04&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM04&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - German Measles </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM05&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM05&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - Disproportion </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM06&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM06&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - External version </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM07&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM07&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - Epilepsy </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM08&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM08&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Obstetric, pregnancy abnormality - Other </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ABNORM09&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ABNORM09&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q37: Bleeding in Pregnancy and before delivery </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;BLEED&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;BLEED&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Q38a: Admission to hospital  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;AD2HOSP&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;AD2HOSP&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Q39: Type of Labour or Delivery Admission (Hospital)  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ADTYPE&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ADTYPE&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Q44: Presenting Part  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;PRESENT&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;PRESENT&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Q49a: No drugs of this type  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG00&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG00&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Chloral, Welldorm  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG01&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG01&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Barbiturate   </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG02&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG02&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Heroin   </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG03&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG03&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Largactil (chlorpomazine)   </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG04&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG04&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Sparine (promazine)    </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG05&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG05&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Phenergan (promethazine)    </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG06&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG06&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Doriden    </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG07&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG07&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Oblivon    </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG08&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG08&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q49a: Other    </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;LDRUG09&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;LDRUG09&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q50: Anaesthetic    </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ATHETIC&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ATHETIC&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q55: Resuscitation    </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;RESUS&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;RESUS&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (None)      </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB1&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Coranine)       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB2&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Lobeline)       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB3&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Sedatives)       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB4&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Antagonists, nalorphine, levalorfan)       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB5&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Synkavit, Vikastab)      </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB6&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Sulphonamides)      </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB7&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB7&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Penicilin)      </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB8&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB8&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Streptomycin)       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB9&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB9&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q56: Drugs to baby (Other antibiotics)       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;DTB10&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DTB10&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Q59: Baby&#39;s Illness       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ILLNESS&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;ILLNESS&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Q61: Month of Death       </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;MOD&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;MOD&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="c1"># Q61: Time of death        </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;TOD&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;TOD&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Q61: Age at Death        </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;AAD&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;AAD&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Q61: Still Birth or Neo-natal Death (Dervied)         </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;SBNND&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SBNND&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># Placental Weight         </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;PLCWGT&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;PLCWGT&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="c1"># Time of death for still births and neonatal deaths (Table 62)          </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;TABLE62&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;TABLE62&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_fill</span>

<span class="c1"># Impute missing data from joined columns using default values</span>
<span class="n">ncds_data_clean</span> <span class="o">=</span> <span class="n">fill_pms_columns</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The columns which help us determine if the patient has epilepsy or not we need to make sure while imputing them to set the values to a default value that does not refect epilepsy</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">### method to fill nulls in the dataset</span>
<span class="k">def</span> <span class="nf">fill_epilepsy_columns</span><span class="p">(</span><span class="n">x_fill</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">x_fill</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="c1"># Q6:Place of Delivery  </span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2032&quot;</span><span class="p">]):</span>
            <span class="n">x_fill</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;n2032&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Impute missing data for epilepsy columns</span>
<span class="n">ncds_data_clean</span> <span class="o">=</span> <span class="n">fill_epilepsy_columns</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the remaining columns for which we have nulls, let us use an algorithim to impute the values</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># find the columns without nulls</span>
<span class="n">columns_no_nulls</span> <span class="o">=</span> <span class="n">find_columns_without_nulls</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>
<span class="c1">#print columns_no_null</span>

<span class="c1"># Find columns with nulls</span>
<span class="n">columns_with_nulls</span> <span class="o">=</span> <span class="n">find_columns_with_nulls</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>

<span class="c1"># Impute missing data with knn</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns_with_nulls</span><span class="p">:</span>
    <span class="n">ncds_data_clean</span> <span class="o">=</span> <span class="n">fill_with_knn</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="n">columns_no_nulls</span><span class="p">,</span><span class="n">column</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us check if we have imputed all the empty columns</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Get the columns which have still null data</span>
<span class="n">columns_with_null</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Predictor  n339  contain null values / Count =  3134
Predictor  n149  contain null values / Count =  3139
Predictor  n1860  contain null values / Count =  3133
Predictor  n2411  contain null values / Count =  3905
Predictor  n2414  contain null values / Count =  3905
Predictor  n1732  contain null values / Count =  3905
Predictor  n1733  contain null values / Count =  3905
Predictor  n1953  contain null values / Count =  3905
Predictor  n2060  contain null values / Count =  3905
Predictor  n2062  contain null values / Count =  3905
Predictor  n2064  contain null values / Count =  3905
Predictor  n2066  contain null values / Count =  3905
Predictor  n2068  contain null values / Count =  3905
Predictor  n2070  contain null values / Count =  3905
Predictor  n2072  contain null values / Count =  3905
Predictor  n2074  contain null values / Count =  3905
Predictor  n2076  contain null values / Count =  3905
Predictor  n2078  contain null values / Count =  3905
Predictor  n2080  contain null values / Count =  3905
Predictor  n2082  contain null values / Count =  3905
Predictor  n2292  contain null values / Count =  3905
Predictor  n1721  contain null values / Count =  3905
Predictor  n1722  contain null values / Count =  3905
Predictor  n2771  contain null values / Count =  3905
Predictor  n2774  contain null values / Count =  3905
Predictor  dvht07  contain null values / Count =  1
Predictor  dvht11  contain null values / Count =  1
Predictor  dvht16  contain null values / Count =  1
Predictor  dvrwt07  contain null values / Count =  1
Predictor  dvrwt11  contain null values / Count =  1
Predictor  dvrwt16  contain null values / Count =  1
Predictor  dvwt07  contain null values / Count =  1
Predictor  dvwt11  contain null values / Count =  1
Predictor  dvwt16  contain null values / Count =  1
Total number of columns with null: 34
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that we still have columns with null values even after trying to impute with knn. So for the remaining columns we can impute with median values for the columns</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Impute missing data with median values</span>
<span class="n">ncds_data_clean</span> <span class="o">=</span> <span class="n">fill_with_median</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>

<span class="c1"># Get the columns which have still null data</span>
<span class="n">columns_with_null</span><span class="p">(</span><span class="n">ncds_data_clean</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Total number of columns with null: 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We finally have a dataset that is filled with data and has no null values</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-4:-Identify-Epilepsy-Records">Step 4: Identify Epilepsy Records<a class="anchor-link" href="#Step-4:-Identify-Epilepsy-Records">&#182;</a></h4><p>In our data a patient is assumed to be epileptic is one or more conditions are satisified in the dataset. We need to check all the conditions in the data and determine if the patient is epileptic.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Columns the help us identify if the patient has epilepsy</span>
<span class="n">epil_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;n390&quot;</span><span class="p">,</span><span class="s2">&quot;n391&quot;</span><span class="p">,</span><span class="s2">&quot;n392&quot;</span><span class="p">,</span><span class="s2">&quot;n415&quot;</span><span class="p">,</span> <span class="s2">&quot;n1842&quot;</span><span class="p">,</span> <span class="s2">&quot;n1307&quot;</span><span class="p">,</span> <span class="s2">&quot;n1308&quot;</span><span class="p">,</span> <span class="s2">&quot;n1309&quot;</span><span class="p">,</span> <span class="s2">&quot;n1314&quot;</span><span class="p">,</span> <span class="s2">&quot;n1317&quot;</span><span class="p">,</span> <span class="s2">&quot;n1477&quot;</span><span class="p">,</span> <span class="s2">&quot;n1478&quot;</span><span class="p">,</span> <span class="s2">&quot;n1479&quot;</span><span class="p">,</span> <span class="s2">&quot;n2416&quot;</span><span class="p">,</span> <span class="s2">&quot;n2663&quot;</span><span class="p">,</span> <span class="s2">&quot;n2664&quot;</span><span class="p">,</span> <span class="s2">&quot;n2665&quot;</span>
                <span class="p">,</span> <span class="s2">&quot;n2666&quot;</span><span class="p">,</span> <span class="s2">&quot;n2667&quot;</span><span class="p">,</span> <span class="s2">&quot;n1893&quot;</span><span class="p">,</span> <span class="s2">&quot;n1894&quot;</span><span class="p">,</span> <span class="s2">&quot;n1895&quot;</span><span class="p">,</span> <span class="s2">&quot;n1904&quot;</span><span class="p">,</span> <span class="s2">&quot;n1910&quot;</span><span class="p">,</span> <span class="s1">&#39;n1817&#39;</span><span class="p">,</span> <span class="s1">&#39;n1818&#39;</span><span class="p">,</span>  <span class="s1">&#39;n1394&#39;</span><span class="p">,</span> <span class="s1">&#39;n1502&#39;</span><span class="p">,</span> <span class="s1">&#39;n2615&#39;</span><span class="p">,</span> <span class="s1">&#39;n2616&#39;</span><span class="p">]</span>

<span class="c1"># Identify if patient has epilepsy</span>
<span class="n">ncds_data_clean</span><span class="p">[</span><span class="s2">&quot;epileptic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># 1M Reason for Special Education MC1:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n390&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">10.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 1M Reason for Special Education MC2:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n391&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">10.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 1M Reason for Special Education MC2:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n392&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">10.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 1M Epileptic condition</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n415&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">3.0</span> <span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 12D Epilepsy identification</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1842&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">5.0</span> <span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2P Has child had epilepsy attacks-MC 1:3</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1307&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1307&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">5.0</span><span class="p">):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2P Has child had epilepsy attacks-MC 2:3</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1308&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1308&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">5.0</span><span class="p">):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2P Has child had epilepsy attacks-MC 3:3</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1309&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1309&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">5.0</span><span class="p">):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2P Age at most recent epilepsy attack</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1314&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2P Age at 1st epilepsy attack</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1317&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2M Reason for special education - MC1:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1477&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2M Reason for special education - MC2:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1478&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2M Reason for special education - MC3:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1479&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P Type hcap for which will require help</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2416&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P Nature of child-s disability-MC 1:5</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2663&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P Nature of child-s disability-MC 2:5</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2664&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P Nature of child-s disability-MC 3:5</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2665&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P Nature of child-s disability-MC 4:5</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2666&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P Nature of child-s disability-MC 5:5</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2667&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">7.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3M Category of child&#39;s handicap MC1:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1893&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">8.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3M Category of child&#39;s handicap MC2:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1894&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">8.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3M Category of child&#39;s handicap MC3:3</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1895&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">8.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3M Reason for hosp admiss last 12 mnths</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1904&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">17.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3M Reason hosp outpatient last yr</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1910&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">17.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3M Epilepsy</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2032&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># New columns </span>
    
    <span class="c1"># 1D Defects found in NCDS1 sample-MC 1:4</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1817&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 1D Defects found in NCDS1 sample-MC 2:4</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1818&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 1D Defects found in NCDS1 sample-MC 3:4</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1819&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2P Ever seen specialist-convulsions,fits</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1394&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">5.0</span><span class="p">:</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2M Has child ever had convulsions</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n1502&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">]):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P When convulsions,fits 1st occured</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2615&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">]):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 3P Convulsions-most recent occurrence</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;n2616&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span><span class="mf">7.0</span><span class="p">]):</span>
        <span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;epileptic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
<span class="k">print</span> <span class="s2">&quot;Number of rows with epilepsy&quot;</span><span class="p">,</span><span class="n">ncds_data_clean</span><span class="p">[</span><span class="n">ncds_data_clean</span><span class="p">[</span><span class="s2">&quot;epileptic&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of rows with epilepsy 1710
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Remove the epilepsy columns from the data</span>
<span class="n">ncds_data_no_indicators</span><span class="o">=</span><span class="n">ncds_data_clean</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ncds_data_no_indicators</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">epil_columns</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Shape of dataset: &quot;</span> <span class="p">,</span> <span class="n">ncds_data_no_indicators</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape of dataset:  (18558, 1803)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-5:-Save-cleaned-data">Step 5: Save cleaned data<a class="anchor-link" href="#Step-5:-Save-cleaned-data">&#182;</a></h4><p>Save our cleaned dataset so we can use it later in our modeling step</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1">### Write the dataframe to a csv file</span>
<span class="n">ncds_data_no_indicators</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;datasets/ncds_data_no_indicators.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>